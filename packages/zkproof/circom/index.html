<!DOCTYPE html>
<html>
  <head>
    <title>Snarkjs client example</title>
  </head>
  <body>
    <h1>Snarkjs client example</h1>
    <button id="bGenProof">Create proof</button>

    <!-- JS-generated output will be added here. -->
    <pre class="proof"> Proof: <code id="proof"></code></pre>

    <pre class="proof"> Result: <code id="result"></code></pre>

    <script src="snarkjs.min.js"></script>

    <!-- This is the bundle generated by rollup.js -->
    <script>
      const proofCompnent = document.getElementById("proof");
      const resultComponent = document.getElementById("result");
      const bGenProof = document.getElementById("bGenProof");

      bGenProof.addEventListener("click", calculateProof);

      async function calculateProof() {
        let secret = {
          ticket:
            "335499083604320209633545586521014302808933324260814122444162011037",
          order: ["1", "1"],
          merkleProof: [
            "1103617138978202414241938091268679119440250876092783492151788124454528626805",
            "6869033472240180546174836934563914719518105041533477758834636380096053669596",
          ],
        };

        const { proof, publicSignals } = await snarkjs.groth16.fullProve(
          secret,
          "http://127.0.0.1:5500/packages/zkproof/circom/merkleTree.wasm",
          "http://127.0.0.1:5500/packages/zkproof/circom/merkle_final.zkey"
        );

        console.log(publicSignals);
        proofCompnent.innerHTML = JSON.stringify(proof, null, 1);

        const vkey = await fetch("verification_key.json").then(function(res) {
          return res.json();
        });

        const res = await snarkjs.groth16.verify(vkey, publicSignals, proof);

        resultComponent.innerHTML = res;
      }
    </script>
  </body>
</html>
